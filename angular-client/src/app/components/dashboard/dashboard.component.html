<div class="dashboard-container">
  <div class="dashboard-grid">
    <!-- Customer Metrics Cards -->
    <div class="metrics-section">
      <div class="metrics-row">
        <!-- Total Customers Metric Card -->
        <app-metric-card
          *ngIf="!loading.customerMetrics && !error.customerMetrics && customerMetrics"
          title="Total Customers"
          [value]="customerMetrics.totalCustomers"
          [changePercent]="customerMetrics.totalCustomersGrowth"
          icon="user"
          colorClass="blue"
        ></app-metric-card>
        
        <div *ngIf="loading.customerMetrics" class="loading-card">
          <div class="loading-spinner"></div>
        </div>
        
        <div *ngIf="!loading.customerMetrics && error.customerMetrics" class="error-card">
          <i class="ri-error-warning-line"></i>
          <span>Error loading data</span>
        </div>
        
        <!-- Active Customers Metric Card -->
        <app-metric-card
          *ngIf="!loading.customerMetrics && !error.customerMetrics && customerMetrics"
          title="Active Customers"
          [value]="customerMetrics.activeCustomers"
          [changePercent]="customerMetrics.activeCustomersGrowth"
          icon="user-check"
          colorClass="blue"
        ></app-metric-card>
        
        <div *ngIf="loading.customerMetrics" class="loading-card">
          <div class="loading-spinner"></div>
        </div>
        
        <div *ngIf="!loading.customerMetrics && error.customerMetrics" class="error-card">
          <i class="ri-error-warning-line"></i>
          <span>Error loading data</span>
        </div>
        
        <!-- Revenue Metric Card -->
        <app-metric-card
          *ngIf="!loading.income && !error.income && income"
          title="Revenue (USD)"
          [value]="income.totalIncome"
          [changePercent]="income.growthRate"
          icon="line-chart"
          colorClass="green"
          valuePrefix="$"
          valueSuffix="M"
        ></app-metric-card>
        
        <div *ngIf="loading.income" class="loading-card">
          <div class="loading-spinner"></div>
        </div>
        
        <div *ngIf="!loading.income && error.income" class="error-card">
          <i class="ri-error-warning-line"></i>
          <span>Error loading data</span>
        </div>
        
        <!-- AUC Metric Card -->
        <app-metric-card
          *ngIf="!loading.aucMetrics && !error.aucMetrics && aucMetrics"
          title="Total AUC"
          [value]="aucMetrics.totalAuc"
          [change]="aucMetrics.growth"
          icon="funds"
          colorClass="purple"
          valuePrefix="$"
          valueSuffix="B"
        ></app-metric-card>
        
        <div *ngIf="loading.aucMetrics" class="loading-card">
          <div class="loading-spinner"></div>
        </div>
        
        <div *ngIf="!loading.aucMetrics && error.aucMetrics" class="error-card">
          <i class="ri-error-warning-line"></i>
          <span>Error loading data</span>
        </div>
      </div>
    </div>
    
    <!-- Charts Row 1 -->
    <div class="charts-row">
      <!-- Customer Growth Chart -->
      <div class="chart-card">
        <app-customer-growth-chart
          *ngIf="!loading.customerGrowth && !error.customerGrowth && customerGrowth.length > 0"
          [data]="customerGrowth"
        ></app-customer-growth-chart>
        
        <div *ngIf="loading.customerGrowth" class="loading-chart">
          <div class="loading-spinner"></div>
        </div>
        
        <div *ngIf="!loading.customerGrowth && error.customerGrowth" class="error-chart">
          <i class="ri-error-warning-line"></i>
          <span>Error loading chart data</span>
        </div>
      </div>
      
      <!-- Customer Segments Chart -->
      <div class="chart-card">
        <app-customer-segments-chart
          *ngIf="!loading.customerSegments && !error.customerSegments && customerSegments.length > 0"
          [data]="customerSegments"
        ></app-customer-segments-chart>
        
        <div *ngIf="loading.customerSegments" class="loading-chart">
          <div class="loading-spinner"></div>
        </div>
        
        <div *ngIf="!loading.customerSegments && error.customerSegments" class="error-chart">
          <i class="ri-error-warning-line"></i>
          <span>Error loading chart data</span>
        </div>
      </div>
    </div>
    
    <!-- Charts Row 2 -->
    <div class="charts-row">
      <!-- Trading Volume Chart -->
      <div class="chart-card">
        <app-trading-volume-chart
          *ngIf="!loading.tradingVolume && !error.tradingVolume && tradingVolume.length > 0"
          [data]="tradingVolume"
        ></app-trading-volume-chart>
        
        <div *ngIf="loading.tradingVolume" class="loading-chart">
          <div class="loading-spinner"></div>
        </div>
        
        <div *ngIf="!loading.tradingVolume && error.tradingVolume" class="error-chart">
          <i class="ri-error-warning-line"></i>
          <span>Error loading chart data</span>
        </div>
      </div>
      
      <!-- AUC Metrics Chart -->
      <div class="chart-card">
        <app-auc-metrics-chart
          *ngIf="!loading.aucMetrics && !error.aucMetrics && aucMetrics"
          [data]="aucMetrics"
        ></app-auc-metrics-chart>
        
        <div *ngIf="loading.aucMetrics" class="loading-chart">
          <div class="loading-spinner"></div>
        </div>
        
        <div *ngIf="!loading.aucMetrics && error.aucMetrics" class="error-chart">
          <i class="ri-error-warning-line"></i>
          <span>Error loading chart data</span>
        </div>
      </div>
    </div>
    
    <!-- Charts Row 3 -->
    <div class="charts-row">
      <!-- Income History Chart -->
      <div class="chart-card">
        <app-income-history-chart
          *ngIf="!loading.incomeHistory && !error.incomeHistory && incomeHistory.length > 0"
          [data]="incomeHistory"
        ></app-income-history-chart>
        
        <div *ngIf="loading.incomeHistory" class="loading-chart">
          <div class="loading-spinner"></div>
        </div>
        
        <div *ngIf="!loading.incomeHistory && error.incomeHistory" class="error-chart">
          <i class="ri-error-warning-line"></i>
          <span>Error loading chart data</span>
        </div>
      </div>
      
      <!-- Income by Service Chart -->
      <div class="chart-card">
        <app-income-service-chart
          *ngIf="!loading.incomeByService && !error.incomeByService && incomeByService.length > 0"
          [data]="incomeByService"
        ></app-income-service-chart>
        
        <div *ngIf="loading.incomeByService" class="loading-chart">
          <div class="loading-spinner"></div>
        </div>
        
        <div *ngIf="!loading.incomeByService && error.incomeByService" class="error-chart">
          <i class="ri-error-warning-line"></i>
          <span>Error loading chart data</span>
        </div>
      </div>
    </div>
    
    <!-- Bottom Row - Top Customers -->
    <div class="charts-row">
      <!-- Top Customers Table -->
      <div class="chart-card full-width">
        <app-top-customers-table
          *ngIf="!loading.topCustomers && !error.topCustomers && topCustomers.length > 0"
          [data]="topCustomers"
        ></app-top-customers-table>
        
        <div *ngIf="loading.topCustomers" class="loading-chart">
          <div class="loading-spinner"></div>
        </div>
        
        <div *ngIf="!loading.topCustomers && error.topCustomers" class="error-chart">
          <i class="ri-error-warning-line"></i>
          <span>Error loading table data</span>
        </div>
      </div>
    </div>
  </div>
</div>
